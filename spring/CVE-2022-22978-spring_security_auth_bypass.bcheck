metadata:
    language: v1-beta
    name: "CVE-2022-22978 Spring Security Authorization Bypass"
    description: "find CVE-2022-22978 Spring Security Authorization Bypass"
    author: "timeshatter"
    tags: "Spring Security Authorization Bypass","CVE-2022-22978"

given request then
    if {base.response.status_code} is "403" then
        send request called check:
            appending path: "%0a"

        if {check.response.status_code} is "200" then
            report issue:
                severity: high
                confidence: tentative
                detail: "find CVE-2022-22978 Spring Security Authorization Bypass"
                remediation: "update Spring Security Authorization."
        end if
    end if
