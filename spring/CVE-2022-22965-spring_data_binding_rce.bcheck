metadata:
    language: v1-beta
    name: "CVE-2022-22965 Spring Data Binding RCE"
    description: "find CVE-2022-22965 Spring Data Binding RCE"
    author: "timeshatter"
    tags: "Spring Data Binding RCE","CVE-2022-22965"

define:
    poc = "class.module.classLoader.URLs%5B0%5D=0"
    poctest = "class.module.classLoader.vulntest=1"

given request then
    send request called check :
        appending queries: {poc}

    if {check.response.status_code} is "400" then
        send request called check2 :
            appending queries: {poctest}
        
        if {check2.response.status_code} is {base.response.status_code} then
            report issue:
                severity: high
                confidence: firm
                detail: "find CVE-2022-22965 Spring Data Binding RCE"
                remediation: "update Spring Data Binding."
        end if
    end if
